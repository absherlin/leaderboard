<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="KZOeBpgAQsYWpkm1YzfzUwl8UpGrD5dNGiLSqZ3S" />
    <title>Leaderboard Panel</title>
    <meta name="googlebot" content="noindex">
    <meta name="robots" content="noindex">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://kit.fontawesome.com/fa489de302.js" crossorigin="anonymous"></script>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        /* General Body and Container Styles */
        body {
            background-color: #000;
            /* Hitam pekat */
            color: #fff;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: 0;
            /* Hapus padding body agar bisa diatur di dalam */
            margin: 0;
            box-sizing: border-box;
        }

        /* Login Container Styles */
        .login-container {
            background-color: #222;
            /* Lebih gelap dari #333 */
            border: 3px groove #FFD700;
            /* Emas */
            border-radius: 10px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            /* Shadow emas */
            text-align: center;
            position: absolute;
            /* Untuk posisi tengah layar */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            /* Pastikan di atas layer lainnya */
        }

        .login-container .logo-login {
            margin-bottom: 25px;
        }

        .login-container .logo-login img {
            max-width: 150px;
            /* Ukuran logo disesuaikan */
            height: auto;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.9));
            /* Shadow pada logo */
        }

        .login-container .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-container label {
            display: block;
            margin-bottom: 8px;
            color: #fff;
            text-shadow: 0 0 3px #000;
        }

        .login-container input[type="text"],
        .login-container input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #FFD700;
            /* Border emas */
            background-color: #1a1a1a;
            /* Background input lebih gelap */
            color: #fff;
            border-radius: 5px;
            box-shadow: inset 0 0 5px rgba(255, 215, 0, 0.5);
            /* Inner shadow emas */
        }

        .login-container button {
            background-color: #6c757d;
            /* Abu-abu */
            color: #fff;
            padding: 10px 25px;
            border: 2px solid #FFD700;
            /* Border kuning emas */
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            margin-top: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .login-container button:hover {
            background-color: #5a6268;
            /* Abu-abu sedikit lebih gelap saat hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.6);
            border-color: #e0b800;
        }

        .login-error {
            color: #dc3545;
            margin-top: 15px;
            font-weight: bold;
        }

        .login-footer-text {
            color: #ccc;
            font-size: 0.8em;
            margin-top: 20px;
        }

        /* --- Main Panel Layout --- */
        #main-panel-content {
            display: none;
            width: 100%;
            min-height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 250px;
            background-color: #1a1a1a;
            border-right: 3px groove #FFD700;
            box-shadow: 2px 0 15px rgba(255, 215, 0, 0.7);
            padding-top: 20px;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #FFD700;
            padding-left: 15px;
            padding-right: 15px;
        }

        .sidebar-header img {
            max-width: 100%;
            height: auto;
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.8));
        }

        .sidebar-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-menu ul li {
            margin-bottom: 10px;
        }

        .sidebar-menu ul li a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #fff;
            text-decoration: none;
            font-size: 1.1em;
            transition: background-color 0.3s ease, color 0.3s ease;
            border-left: 5px solid transparent;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            margin: 0 10px;
            width: calc(100% - 20px);
        }

        .sidebar-menu ul li a i {
            margin-right: 10px;
            color: #FFD700;
        }

        .sidebar-menu ul li a:hover,
        .sidebar-menu ul li a.active {
            background-color: #333;
            color: #FFD700;
            border-left: 5px solid #FFD700;
        }

        .sidebar-menu .submenu {
            list-style: none;
            padding: 0;
            margin-left: 20px;
            border-left: 1px dashed #FFD700;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .sidebar-menu .submenu.show {
            max-height: 200px;
        }

        .sidebar-menu .submenu li a {
            padding: 8px 20px 8px 30px;
            font-size: 1em;
            color: #ccc;
            border-radius: 0;
            box-shadow: none;
            margin: 0;
            width: 100%;
        }

        .sidebar-menu .submenu li a:hover,
        .sidebar-menu .submenu li a.active {
            background-color: #444;
            color: #FFD700;
            border-left: none;
        }


        .main-content {
            flex-grow: 1;
            padding: 20px;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
        }

        .panel-header {
            width: 100%;
            max-width: 800px;
            background-color: #222;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .panel-header h2 {
            color: #FFD700;
            text-shadow: 0 0 5px #FFD700;
            margin: 0;
            flex-grow: 1;
            text-align: center;
        }

        #logout-button {
            background-color: #dc3545;
            color: #fff;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease;
            white-space: nowrap;
            margin-left: 15px;
        }

        #logout-button:hover {
            background-color: #c82333;
        }

        /* Dashboard Specific Styles */
        #dashboard-view {
            display: none;
            width: 100%;
            max-width: 800px;
            text-align: center;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #dashboard-view .dashboard-cards {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
        }

        #dashboard-view .dashboard-card {
            background-color: #222;
            border: 3px groove #FFD700;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            text-align: center;
            flex: 0 0 100%;
            max-width: 800px;
        }

        #dashboard-view .dashboard-card h3 {
            color: #FFD700;
            margin-bottom: 15px;
            text-shadow: 0 0 5px #FFD700;
        }

        #dashboard-view .dashboard-card .value {
            font-size: 2.5em;
            font-weight: bold;
            color: #00ff00;
            margin-bottom: 10px;
        }

        #dashboard-view .dashboard-member-list {
            background-color: #222;
            border: 3px groove #FFD700;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        #dashboard-view .dashboard-member-list h4 {
            color: #FFD700;
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
            text-shadow: 0 0 3px #FFD700;
        }

        #dashboard-view .dashboard-member-list ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #dashboard-view .dashboard-member-list li {
            color: #fff;
            padding: 5px 0;
            border-bottom: 1px solid #555;
        }

        #dashboard-view .dashboard-member-list li:last-child {
            border-bottom: none;
        }

        /* Player Management View - Make sure it displays correctly */
        #player-management-view {
            display: none;
            /* Controlled by JS */
            width: 100%;
            max-width: 800px;
            /* Lebar maksimum konsisten */
            flex-direction: column;
            align-items: center;
            gap: 20px;
            /* Jarak antar elemen utama di view ini */
        }

        /* Styles for Leaderboard within Player Management - INI FOKUS UTAMA PERBAIKAN */
        /* Menggunakan style dari script yang Anda berikan (warna FF920C) */
        .admin-panel {
            /* Ini untuk "ADMIN LEADERBOARD PANEL" */
            background-color: #4a4a4a;
            border: 3px #FF920C groove;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            /* Jarak bawah */
            width: 100%;
            max-width: 600px;
            /* Lebar maksimum untuk form input */
            box-shadow: 0 0 15px rgba(208, 168, 89, 0.7);
        }

        .admin-panel h3 {
            /* Judul di admin panel */
            color: #FF920C;
            text-shadow: 0 0 5px #FF920C;
            text-align: center;
            margin-bottom: 20px;
        }

        .admin-panel input[type="text"],
        .admin-panel input[type="number"],
        .admin-panel input[type="date"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #FF920C;
            background-color: #222;
            color: #fff;
            border-radius: 5px;
        }

        .admin-panel button {
            background-color: #008000;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }

        .admin-panel button:hover {
            background-color: #00aa00;
        }

        .admin-panel button.delete-btn {
            background-color: #dc3545;
        }

        .admin-panel button.delete-btn:hover {
            background-color: #a71d2a;
        }

        .admin-panel button.delete-all-btn {
            background-color: #ff0000;
            border: 2px solid #fff;
            font-weight: bold;
            animation: pulse 1.5s infinite;
        }

        .admin-panel button.delete-all-btn:hover {
            background-color: #cc0000;
            animation: none;
        }

        /* Style untuk tombol import excel */
        .btn-import-excel {
            background-color: #28a745;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            text-align: center;
            margin-top: 10px;
            width: 100%;
            transition: background-color 0.3s ease;
        }

        .btn-import-excel:hover {
            background-color: #218838;
        }

        .admin-id-list {
            /* Ini untuk "Daftar ID Player (Full & Masked)" */
            margin-top: 20px;
            background-color: #3d3d3d;
            border: 1px solid #FF920C;
            border-radius: 8px;
            padding: 10px;
        }

        .admin-id-list h4 {
            color: #FF920C;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 3px #FF920C;
        }

        .admin-id-list table {
            width: 100%;
            border-collapse: collapse;
            /* Penting untuk border */
        }

        .admin-id-list th,
        .admin-id-list td {
            border: 1px solid #555;
            padding: 8px;
            text-align: left;
            color: #fff;
        }

        .admin-id-list th {
            background-color: #555;
            color: #FF920C;
        }


        .ardframe.checkpoin {
            /* Ini untuk leaderboard utama */
            border: 3px #FF920C groove;
            border-radius: 10px;
            padding: 20px;
            background-color: #333;
            box-shadow: 0 0 15px rgba(255, 146, 12, 0.7);
            width: 100%;
            /* Memastikan mengisi lebar parent */
            max-width: 800px;
            /* Lebar maksimum konsisten */
            margin: 0 auto;
            /* Memusatkan secara horizontal */
        }

        .table-ard-container {
            /* Kontainer tabel leaderboard utama */
            max-height: 350px;
            overflow-y: auto;
            border: 3px #FF920C groove;
            border-radius: 10px;
        }

        .table-ard {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            /* Hapus spasi antar sel */
        }

        .table-ard thead th {
            font-family: 'Anek Latin', sans-serif;
            text-shadow: 0 0 3px #000, 0 0 5px #000;
            border: 3px #FF920C groove;
            color: #fff;
            padding: 10px;
            text-align: center;
            vertical-align: middle;
            border-radius: 10px;
            background-color: #555;
            padding: 15px 10px;
            font-size: 18px !important;
            border-bottom: 1px solid white;
            filter: drop-shadow(1px 2px 6px gold);
            position: sticky;
            top: 0;
            z-index: 1;
            box-sizing: border-box;
        }

        .table-ard tbody td {
            font-family: 'Anek Latin', sans-serif;
            text-shadow: 0 0 3px #000, 0 0 5px #000;
            border: 3px #FF920C groove;
            /* Border per sel di tabel utama */
            color: #fff;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
            border-radius: 10px;
            box-sizing: border-box;
        }

        /* Baris ganjil/genap */
        .table-ard tbody tr:nth-child(odd) {
            background-color: #444;
        }

        .table-ard tbody tr:nth-child(even) {
            background-color: #3d3d3d;
        }


        .search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search input {
            flex-grow: 1;
            padding: 8px;
            border: 3px #FF920C groove;
            background-color: #222;
            color: #fff;
            border-radius: 10px;
        }

        .search div[role="button"] {
            background-color: #FF920C;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
        }

        .search div[role="button"] img {
            height: 24px;
        }

        .ardboard {
            margin-top: 20px;
        }

        /* Styles for Reward Image Popup */
        .layer2 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .reward {
            background-color: #333 !important;
            padding: 20px;
            border: 3px #FF920C groove !important;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 0 20px rgba(255, 146, 12, 0.8) !important;
        }

        .reward .ard-close {
            background-color: #555 !important;
            border: 3px #FF920C groove !important;
        }

        .reward .ard-close:hover {
            background-color: #e08200 !important;
        }

        /* --- Custom Welcome Pop-up Styles --- */
        .custom-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            /* Background gelap transparan */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .custom-popup-content {
            background-color: #222;
            /* Background gelap pop-up */
            border: 3px groove #FFD700;
            /* Border emas */
            border-radius: 10px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            /* Shadow emas */
            animation: fadeInScale 0.3s ease-out;
        }

        .custom-popup-content .check-icon {
            font-size: 3em;
            color: #00ff00;
            /* Hijau untuk centang */
            margin-bottom: 15px;
            filter: drop-shadow(0 0 5px rgba(0, 255, 0, 0.5));
        }

        .custom-popup-content h3 {
            color: #fff;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .custom-popup-content p {
            color: #FFD700;
            /* Warna emas untuk teks utama */
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }

        .custom-popup-content .popup-button {
            background-color: #007bff;
            /* Biru cerah untuk tombol OK */
            color: #fff;
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
        }

        .custom-popup-content .popup-button:hover {
            background-color: #0056b3;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000;
            }

            50% {
                transform: scale(1.05);
                box-shadow: 0 0 15px #ff0000, 0 0 25px #ff0000;
            }

            100% {
                transform: scale(1);
                box-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000;
            }
        }


        /* Mobile specific adjustments */
        @media (max-width: 767px) {
            .login-container {
                max-width: 90%;
                padding: 20px;
            }

            .login-container h2 {
                font-size: 1.8em;
            }

            .login-container button {
                font-size: 1em;
                padding: 8px 20px;
            }

            .sidebar {
                width: 100px;
                padding-top: 10px;
            }

            .sidebar-header {
                padding-left: 10px;
                padding-right: 10px;
                margin-bottom: 20px;
            }

            .sidebar-menu ul li a {
                padding: 8px 10px;
                font-size: 0.9em;
                justify-content: center;
                flex-direction: column;
                margin: 0 5px;
                width: calc(100% - 10px);
            }

            .sidebar-menu .submenu {
                margin-left: 0;
                border-left: none;
            }

            .sidebar-menu .submenu li a {
                padding: 5px 10px;
                font-size: 0.8em;
            }

            .main-content {
                padding: 10px;
            }

            .panel-header {
                max-width: 95%;
                flex-direction: column;
                align-items: center;
            }

            .panel-header h2 {
                font-size: 1.2em;
            }

            #logout-button {
                position: relative;
                top: auto;
                right: auto;
                transform: none;
                margin-top: 10px;
                margin-left: 0;
                width: 100%;
            }

            .checkpoin,
            .admin-panel,
            #dashboard-view .dashboard-card,
            #dashboard-view .dashboard-member-list {
                width: 95%;
                padding: 15px;
            }

            .title h1 {
                font-size: 2.2em;
            }

            .search input,
            .admin-panel input,
            .admin-panel button {
                font-size: 0.9em;
                padding: 6px;
            }

            .table-ard th,
            .table-ard td {
                font-size: 0.8em !important;
                padding: 6px;
            }

            .marquee {
                width: 90%;
            }

            #dashboard-view .dashboard-card {
                min-width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="login-container" id="login-form">
        <div class="logo-login">
            <img src="https://139.99.53.232/storage/games/Yi93k8m4tp2ldtwIGE6TgXSwRgSnc9tMnpwcsUos.png"
                alt="Company Logo">
        </div>
        <div class="form-group">
            <label for="username">ID Pengguna:</label>
            <input type="text" id="username" placeholder="Masukkan ID Pengguna">
        </div>
        <div class="form-group">
            <label for="password">Kata Sandi:</label>
            <input type="password" id="password" placeholder="Masukkan Kata Sandi">
        </div>
        <button onclick="checkLogin()">Login</button>
        <p class="login-error" id="login-error-message" style="display: none;">ID Pengguna atau Kata Sandi salah!</p>
        <p class="login-footer-text">Set Up By JX ©2025</p>
    </div>

    <div id="main-panel-content">
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="https://139.99.53.232/storage/games/Yi93k8m4tp2ldtwIGE6TgXSwRgSnc9tMnpwcsUos.png"
                    alt="Admin Panel Logo">
            </div>
            <nav class="sidebar-menu">
                <ul>
                    <li><a href="#" class="nav-link active" data-view="dashboard"><i class="fas fa-tachometer-alt"></i>
                            Dashboard</a></li>
                    <li>
                        <a href="#" class="nav-link dropdown-toggle" data-view="data-member"><i
                                class="fas fa-users"></i> Data Member</a>
                        <ul class="submenu">
                            <li><a href="#" class="nav-link" data-view="player-management">Player</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="main-content">
            <div class="panel-header">
                <h2 id="welcome-text">PANEL SET UP MEMBER AIRBET88</h2>
                <button id="logout-button" onclick="logout()">Logout <i class="fas fa-sign-out-alt"></i></button>
            </div>

            <div id="dashboard-view">
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <h3><i class="fas fa-users"></i> Total Registered Members</h3>
                        <div class="value" id="total-registered-members">0</div>
                    </div>
                </div>
                <div class="dashboard-member-list">
                    <h4>Daftar ID Member</h4>
                    <ul id="dashboard-member-id-list">
                    </ul>
                </div>
            </div>

            <div id="player-management-view">
                <div class="title-container">
                    <div class="title rsive">
                        <h1>LEADERBOARD</h1>
                    </div>
                    <center style="width: 100%;">
                        <div class="marquee">
                            <div class="marquee-content">
                                <b> UPDATE POINT LEADERBOARD AIRBET88 </b>
                            </div>
                        </div>
                    </center>
                </div>

                <div class="admin-panel">
                    <h3>ADMIN LEADERBOARD PANEL</h3>

                    <div class="form-group">
                        <label for="admin_user_id">ID Player (Manual):</label>
                        <input type="text" id="admin_user_id" placeholder="Masukkan ID Player">
                    </div>
                    <div class="form-group">
                        <label for="admin_points">Freechip:</label>
                        <input type="number" id="admin_points" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="admin_joined_date">Joined Date:</label>
                        <input type="date" id="admin_joined_date">
                    </div>
                    <div class="form-group">
                        <button onclick="addOrUpdatePlayer()">Tambah / Update Player</button>
                        <button class="delete-btn" onclick="deletePlayer()">Hapus Player (berdasarkan ID)</button>
                    </div>

                    <hr style="border-color: #FF920C; margin: 25px 0;">

                    <div>
                        <h4 style="color: #FF920C; text-align:center; text-shadow: 0 0 3px #FF920C;">Upload Massal via
                            Excel</h4>
                        <div class="form-group">
                            <button onclick="downloadExcelTemplate()" style="background-color: #17a2b8;">Download
                                Template Excel</button>
                        </div>
                        <div class="form-group">
                            <label for="excel-file-input" class="btn-import-excel">Import dari File Excel</label>
                            <input type="file" id="excel-file-input" onchange="importFromExcel(event)"
                                accept=".xlsx, .xls" style="display: none;">
                        </div>
                    </div>

                    <div class="admin-id-list">
                        <h4>Daftar ID Player (Full & Masked)</h4>
                        <div style="max-height: 200px; overflow-y: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID Lengkap</th>
                                        <th>ID Tersembunyi</th>
                                    </tr>
                                </thead>
                                <tbody id="admin_id_list_body">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div style="margin-top: 25px; padding: 15px; border: 2px solid red; border-radius: 10px;">
                        <h4 style="color: red; text-align:center; font-weight: bold;">DANGER ZONE</h4>
                        <button class="delete-all-btn" onclick="deleteAllPlayers()">Hapus Semua Player</button>
                    </div>

                </div>

                <div class="ardframe rsive checkpoin">
                    <div class="search">
                        <input class="ardframe" maxlength="12" type="text" name="user" id="user"
                            placeholder="USER ID">
                        <div role="button" type="submit" onclick="searchLeaderboard()">
                            <img src="https://wall2.airbet88-vip.com/assets/desktop/search.webp" alt="Search">
                        </div>
                    </div>
                    <main class="ardboard">
                        <div id="klasemen">
                            <div class="card-body p-1 p-lg-3 rankto onn">
                                <div class="table-ard-container">
                                    <table class="table-ard">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <span>ID PLAYER</span>
                                                </th>
                                                <th>
                                                    <span>FREECHIP</span>
                                                </th>
                                                <th>
                                                    <span>JOINED DATE</span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <div class="layer2"
                style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:1000; justify-content:center; align-items:center;">
                <div class="ardframe reward"
                    style="background-color:#333; padding:20px; border:3px #FF920C groove; border-radius:10px; max-width:600px; width:90%; box-shadow:0 0 20px rgba(255,146,12,0.8);">
                    <div class="content-text">
                        <div id="carouselhadiah" class="carousel slide">
                            <div class="carousel-indicators">
                                <button type="button" data-bs-target="#carouselhadiah" data-bs-slide-to="0"
                                    class="active" aria-current="true" aria-label="Slide 1"></button>
                                <button type="button" data-bs-target="#carouselhadiah" data-bs-slide-to="1"
                                    aria-label="Slide 2"></button>
                            </div>
                            <div class="carousel-inner m-auto">
                                <div class="carousel-item active">
                                    <img id="carouselImage1" src="" alt="1" class="desktop-image"
                                        style="max-width: 100%; height: auto; display: block; margin: auto;">
                                </div>
                                <div class="carousel-item">
                                    <img id="carouselImage2" src="" alt="2" class="desktop-image"
                                        style="max-width: 100%; height: auto; display: block; margin: auto;">
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselhadiah"
                                data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselhadiah"
                                data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                    <div class="btn-container" style="margin-top:20px;">
                        <div class="ardframe ard-close" onclick="hideRewardList()" role="button"
                            style="border: 3px #FF920C groove; border-radius: 10px; padding: 8px 15px; text-shadow: 0 0 3px #000, 0 0 5px #000; color: #fff; cursor:pointer; background-color:#555;">
                            CLOSE
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="welcome-popup-overlay" class="custom-popup-overlay" style="display: none;">
        <div class="custom-popup-content">
            <div class="check-icon"><i class="fas fa-check-circle"></i></div>
            <h3>Welcome</h3>
            <p id="popup-username">PIC_PSJ</p>
            <p>You've Been Successfully Login</p>
            <button class="popup-button" onclick="hideWelcomePopup()">OK</button>
        </div>
    </div>

    <script>
        // --- Firebase Configuration & Initialization ---
        const firebaseConfig = {
            apiKey: "AIzaSyBF1wL19U-JWx3FhbcQkx2sZzZuLwl7Y8Y",
            authDomain: "leaderboard-ai.firebaseapp.com",
            projectId: "leaderboard-ai",
            storageBucket: "leaderboard-ai.firebasestorage.app",
            messagingSenderId: "604627461547",
            appId: "1:604627461547:web:b13c93190b415e07c01eee",
            measurementId: "G-PNZ2PTE24B"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = app.firestore();

        let leaderboardData = [];

        function maskUsername(username) {
            if (!username) return "";
            username = String(username);
            if (username.length <= 4) return username;
            return username.substring(0, 2) + "***" + username.substring(username.length - 2, username.length);
        }

        function updateDashboardStats() {
            $('#total-registered-members').text(leaderboardData.length);
        }

        function renderDashboardMemberList() {
            const memberListUl = $('#dashboard-member-id-list');
            memberListUl.empty();

            if (leaderboardData.length > 0) {
                const sortedMembers = [...leaderboardData].sort((a, b) => a.username.localeCompare(b.username));
                sortedMembers.forEach(player => {
                    memberListUl.append(`<li>${player.username}</li>`);
                });
            } else {
                memberListUl.append(`<li>No members registered yet.</li>`);
            }
        }

        function renderLeaderboard(dataToShow) {
            let htmlView = '';
            const tbody = $('.table-ard tbody');

            if (dataToShow.length <= 0) {
                htmlView += `
                        <tr>
                            <td colspan="3" style="border: unset; border-radius: 10px; padding: 5px; text-shadow: 0 0 3px #000000, 0 0 5px #000000; border-color: #d0a859; color: #fff; border: 3px #FF920C groove; ">No data.</td>
                        </tr>`;
            } else {
                dataToShow.sort((a, b) => b.point - a.point);

                for (let i = 0; i < dataToShow.length; i++) {
                    let player = dataToShow[i];
                    htmlView +=
                        `<tr>
                                <td class="mb-3 table-ard-point position-relative">` +
                        maskUsername(player.username) + `</td>
                                <td class="mb-3 table-ard-point position-relative">` +
                        player.point + `</td>
                                <td class="mb-3 table-ard-point position-relative">` +
                        player.joined_date + `</td>
                            </tr>`;
                }
            }
            tbody.html(htmlView);
        }

        function renderAdminIdList() {
            let htmlView = '';
            const adminIdListBody = $('#admin_id_list_body');
            adminIdListBody.empty();

            if (leaderboardData.length <= 0) {
                htmlView += `
                        <tr>
                            <td colspan="2" style="text-align: center;">No player IDs added yet.</td>
                        </tr>`;
            } else {
                const sortedLeaderboardData = [...leaderboardData].sort((a, b) => a.username.localeCompare(b.username));
                sortedLeaderboardData.forEach(player => {
                    htmlView += `
                                <tr>
                                    <td>${player.username}</td>
                                    <td>${maskUsername(player.username)}</td>
                                </tr>
                            `;
                });
            }
            adminIdListBody.html(htmlView);
        }

        function searchLeaderboard() {
            var keyword = $('#user').val().toLowerCase();
            let filteredData = leaderboardData.filter(player =>
                player.username.toLowerCase().includes(keyword)
            );
            renderLeaderboard(filteredData);
        }

        async function fetchLeaderboardData() {
            try {
                db.collection("players").orderBy("point", "desc")
                    .onSnapshot((querySnapshot) => {
                        leaderboardData = [];
                        querySnapshot.forEach((doc) => {
                            leaderboardData.push({ id: doc.id, ...doc.data() });
                        });

                        renderLeaderboard(leaderboardData);
                        renderAdminIdList();
                        updateDashboardStats();
                        renderDashboardMemberList();
                        console.log("Leaderboard updated from Firestore (real-time)!");
                    }, (error) => {
                        console.error("Error getting real-time updates from Firestore: ", error);
                        alert('Gagal mengambil data leaderboard. Periksa konsol.');
                    });
            } catch (error) {
                console.error('Error initiating Firestore listener:', error);
                alert('Gagal terhubung ke Firestore. Periksa konfigurasi Firebase Anda.');
            }
        }

        async function addOrUpdatePlayer() {
            let id = $('#admin_user_id').val().trim();
            let points = parseInt($('#admin_points').val());
            let date = $('#admin_joined_date').val();

            if (!id || isNaN(points) || !date) {
                alert("Semua field (ID, Freechip, Tanggal) harus diisi dengan benar untuk penambahan manual!");
                return;
            }

            const [year, month, day] = date.split('-');
            const formattedDate = `${day}-${month}-${year}`;

            const playerData = {
                username: id,
                point: points,
                joined_date: formattedDate
            };

            try {
                await db.collection("players").doc(id).set(playerData, { merge: true });
                alert(`Player ${id} berhasil diproses di Firestore!`);
                clearAdminForm();
            } catch (error) {
                console.error('Error adding/updating player:', error);
                alert('Gagal menambah/mengupdate player di Firestore.');
            }
        }

        async function deletePlayer() {
            let idToDelete = $('#admin_user_id').val().trim();
            if (!idToDelete) {
                alert("Masukkan ID Player di form manual yang ingin dihapus!");
                return;
            }

            if (!confirm(`Anda yakin ingin menghapus player dengan ID: ${idToDelete}?`)) {
                return;
            }

            try {
                await db.collection("players").doc(idToDelete).delete();
                alert(`Player ${idToDelete} berhasil dihapus dari Firestore!`);
                clearAdminForm();
            } catch (error) {
                console.error('Error deleting player:', error);
                alert('Gagal menghapus player dari Firestore.');
            }
        }

        // --- Fungsi untuk Excel & Hapus Semua ---

        function downloadExcelTemplate() {
            const headers = ["ID Player", "Freechip", "Joined Date"];
            const exampleData = [
                ["contoh_id_1", 100, "20-06-2025"],
                ["contoh_id_2", 150, "21-06-2025"]
            ];
            const dataToExport = [headers, ...exampleData];
            const ws = XLSX.utils.aoa_to_sheet(dataToExport);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "DataMember");
            XLSX.writeFile(wb, "Template_Data_Member.xlsx");
        }

        function importFromExcel(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async function (e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array', cellDates: true });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                if (jsonData.length < 2) {
                    alert("File Excel kosong atau hanya berisi header.");
                    document.getElementById('excel-file-input').value = '';
                    return;
                }

                if (!confirm(`Ditemukan ${jsonData.length - 1} data player. Apakah Anda yakin ingin mengimpor semua data ini? Data yang sudah ada akan diupdate.`)) {
                    document.getElementById('excel-file-input').value = '';
                    return;
                }

                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    const id = row[0];
                    const points = parseInt(row[1]);
                    let joinedDateValue = row[2];

                    if (!id || isNaN(points) || !joinedDateValue) {
                        console.warn(`Melewatkan baris ${i + 1} karena data tidak lengkap:`, row);
                        continue;
                    }

                    let formattedDate;
                    if (joinedDateValue instanceof Date) {
                        let day = String(joinedDateValue.getDate()).padStart(2, '0');
                        let month = String(joinedDateValue.getMonth() + 1).padStart(2, '0'); // Months are 0-based
                        let year = joinedDateValue.getFullYear();
                        formattedDate = `${day}-${month}-${year}`;
                    } else {
                        formattedDate = String(joinedDateValue); // Asumsikan format sudah benar jika bukan object Date
                    }

                    const playerData = {
                        username: String(id).trim(),
                        point: points,
                        joined_date: formattedDate
                    };

                    try {
                        await db.collection("players").doc(playerData.username).set(playerData, { merge: true });
                        console.log(`Berhasil memproses player: ${playerData.username}`);
                    } catch (error) {
                        console.error(`Gagal memproses player ${playerData.username}:`, error);
                    }
                }

                alert("Proses impor dari Excel selesai. Leaderboard akan diperbarui secara otomatis.");
                document.getElementById('excel-file-input').value = '';
            };

            reader.readAsArrayBuffer(file);
        }

        async function deleteAllPlayers() {
            // Konfirmasi Lapis 1
            if (!confirm("PERINGATAN KERAS!\n\nAnda akan menghapus SEMUA data player. Tindakan ini TIDAK BISA DIBATALKAN. Apakah Anda benar-benar yakin?")) {
                return;
            }

            // Konfirmasi Lapis 2
            const confirmationText = "SAYA YAKIN HAPUS";
            const userInput = prompt(`Untuk melanjutkan, ketik "${confirmationText}" di bawah ini. Jika salah ketik, proses akan dibatalkan.`);

            if (userInput !== confirmationText) {
                alert("Input salah. Proses penghapusan semua data dibatalkan.");
                return;
            }

            alert("Konfirmasi diterima. Memulai proses penghapusan semua data...");

            try {
                const querySnapshot = await db.collection("players").get();
                if (querySnapshot.empty) {
                    alert("Tidak ada data untuk dihapus.");
                    return;
                }

                // Buat batch untuk menghapus semua dokumen
                const batch = db.batch();
                querySnapshot.forEach(doc => {
                    batch.delete(doc.ref);
                });

                // Jalankan batch
                await batch.commit();
                alert("SUKSES! Semua data player telah berhasil dihapus dari database.");
                // Tampilan akan otomatis terupdate karena onSnapshot
            } catch (error) {
                console.error("Error saat menghapus semua player:", error);
                alert("Terjadi kesalahan saat mencoba menghapus semua data. Silakan cek konsol untuk detailnya.");
            }
        }

        // --- Akhir dari fungsi-fungsi tersebut ---

        function clearAdminForm() {
            $('#admin_user_id').val('');
            $('#admin_points').val('0');
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            $('#admin_joined_date').val(`${year}-${month}-${day}`);
        }

        function showRewardList() {
            document.querySelector(".layer2").style.display = "flex";
            setCarouselImages();
        }

        function hideRewardList() {
            document.querySelector(".layer2").style.display = "none";
        }

        function setCarouselImages() {
            const carouselImage1 = document.getElementById('carouselImage1');
            const carouselImage2 = document.getElementById('carouselImage2');
            if (window.innerWidth <= 767) {
                carouselImage1.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20B_.png";
                carouselImage2.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20A.png";
            } else {
                carouselImage1.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20D.png";
                carouselImage2.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20C.png";
            }
        }

        function showWelcomePopup(username) {
            $('#popup-username').text(username);
            $('#welcome-popup-overlay').fadeIn(300);
        }

        function hideWelcomePopup() {
            $('#welcome-popup-overlay').fadeOut(300);
        }

        function logout() {
            if (confirm("Anda yakin ingin logout?")) {
                $('#main-panel-content').hide();
                $('#login-form').show();
                $('#username').val('');
                $('#password').val('');
                $('#login-error-message').hide();
                leaderboardData = [];
                renderLeaderboard([]);
                renderAdminIdList();
                updateDashboardStats();
                renderDashboardMemberList();
            }
        }

        const CORRECT_USERNAME = "ADMIN";
        const CORRECT_PASSWORD = "Click8899";
        const PANEL_WELCOME_TEXT = "PANEL SET UP MEMBER AIRBET88";

        function checkLogin() {
            const usernameInput = $('#username').val();
            const passwordInput = $('#password').val();
            const errorMessage = $('#login-error-message');

            if (usernameInput === CORRECT_USERNAME && passwordInput === CORRECT_PASSWORD) {
                $('#login-form').hide();
                $('#main-panel-content').css('display', 'flex');
                $('#welcome-text').text(PANEL_WELCOME_TEXT);

                initAdminPanel();
                showView('dashboard');

                setTimeout(() => {
                    showWelcomePopup(usernameInput);
                }, 200);
            } else {
                errorMessage.text("ID Pengguna atau Kata Sandi salah!");
                errorMessage.show();
            }
        }

        function showView(viewName) {
            $('#dashboard-view').hide();
            $('#player-management-view').hide();

            $(`#${viewName}-view`).css('display', 'flex');

            $('.sidebar-menu .nav-link').removeClass('active');
            $('.sidebar-menu .submenu').removeClass('show');

            let targetLink;
            if (viewName === 'player-management') {
                targetLink = $(`.sidebar-menu .nav-link[data-view="data-member"]`);
                targetLink.parent().find('.submenu').addClass('show');
                $(`.sidebar-menu .submenu li a[data-view="player-management"]`).addClass('active');
            } else {
                targetLink = $(`.sidebar-menu .nav-link[data-view="${viewName}"]`);
                targetLink.addClass('active');
            }
        }

        function initAdminPanel() {
            clearAdminForm();
            $('#user').on('keyup', searchLeaderboard);
            setCarouselImages();
            $(window).on('resize', setCarouselImages);

            $('.sidebar-menu .nav-link').on('click', function (e) {
                e.preventDefault();
                const targetView = $(this).data('view');
                const isSubmenuLink = $(this).parent().parent().hasClass('submenu');

                if (targetView) {
                    showView(targetView);
                }

                if ($(this).hasClass('dropdown-toggle')) {
                    $(this).next('.submenu').toggleClass('show');
                } else if (!isSubmenuLink) {
                    $('.sidebar-menu .submenu').removeClass('show');
                }
            });

            fetchLeaderboardData();
        }

        $(document).ready(function () {
            $('#main-panel-content').hide();
            clearAdminForm();
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
</body>

</html>