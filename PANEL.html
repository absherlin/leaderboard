<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="KZOeBpgAQsYWpkm1YzfzUwl8UpGrD5dNGiLSqZ3S" />
    <title>Leaderboard Panel</title>
    <meta name="googlebot" content="noindex">
    <meta name="robots" content="noindex">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://kit.fontawesome.com/fa489de302.js" crossorigin="anonymous"></script>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        /* General Body and Container Styles */
        body {
            background-color: #000; /* Hitam pekat */
            color: #fff;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: 0; /* Hapus padding body agar bisa diatur di dalam */
            margin: 0;
            box-sizing: border-box;
        }

        /* Login Container Styles */
        .login-container {
            background-color: #222; /* Lebih gelap dari #333 */
            border: 3px groove #FFD700; /* Emas */
            border-radius: 10px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7); /* Shadow emas */
            text-align: center;
            position: absolute; /* Untuk posisi tengah layar */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10; /* Pastikan di atas layer lainnya */
        }

        .login-container .logo-login {
            margin-bottom: 25px;
        }

        .login-container .logo-login img {
            max-width: 150px; /* Ukuran logo disesuaikan */
            height: auto;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.9)); /* Shadow pada logo */
        }

        .login-container .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-container label {
            display: block;
            margin-bottom: 8px;
            color: #fff;
            text-shadow: 0 0 3px #000;
        }

        .login-container input[type="text"],
        .login-container input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #FFD700; /* Border emas */
            background-color: #1a1a1a; /* Background input lebih gelap */
            color: #fff;
            border-radius: 5px;
            box-shadow: inset 0 0 5px rgba(255, 215, 0, 0.5); /* Inner shadow emas */
        }

        .login-container button {
            background-color: #6c757d; /* Abu-abu */
            color: #fff;
            padding: 10px 25px;
            border: 2px solid #FFD700; /* Border kuning emas */
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            margin-top: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .login-container button:hover {
            background-color: #5a6268; /* Abu-abu sedikit lebih gelap saat hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.6);
            border-color: #e0b800;
        }

        .login-error {
            color: #dc3545;
            margin-top: 15px;
            font-weight: bold;
        }

        .login-footer-text {
            color: #ccc;
            font-size: 0.8em;
            margin-top: 20px;
        }

        /* --- Main Panel Layout --- */
        #main-panel-content {
            display: none;
            width: 100%;
            min-height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 250px;
            background-color: #1a1a1a;
            border-right: 3px groove #FFD700;
            box-shadow: 2px 0 15px rgba(255, 215, 0, 0.7);
            padding-top: 20px;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #FFD700;
        }

        .sidebar-header h2 {
            color: #FFD700;
            text-shadow: 0 0 5px #FFD700;
            font-size: 1.8em;
            margin: 0;
        }

        .sidebar-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-menu ul li {
            margin-bottom: 10px;
        }

        .sidebar-menu ul li a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #fff;
            text-decoration: none;
            font-size: 1.1em;
            transition: background-color 0.3s ease, color 0.3s ease;
            border-left: 5px solid transparent;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            margin: 0 10px;
            width: calc(100% - 20px);
        }

        .sidebar-menu ul li a i {
            margin-right: 10px;
            color: #FFD700;
        }

        .sidebar-menu ul li a:hover,
        .sidebar-menu ul li a.active {
            background-color: #333;
            color: #FFD700;
            border-left: 5px solid #FFD700;
        }

        .sidebar-menu .submenu {
            list-style: none;
            padding: 0;
            margin-left: 20px;
            border-left: 1px dashed #FFD700;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .sidebar-menu .submenu.show {
            max-height: 200px;
        }

        .sidebar-menu .submenu li a {
            padding: 8px 20px 8px 30px;
            font-size: 1em;
            color: #ccc;
            border-radius: 0;
            box-shadow: none;
            margin: 0;
            width: 100%;
        }

        .sidebar-menu .submenu li a:hover,
        .sidebar-menu .submenu li a.active {
            background-color: #444;
            color: #FFD700;
            border-left: none;
        }


        .main-content {
            flex-grow: 1;
            padding: 20px;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
        }

        .panel-header {
            width: 100%;
            max-width: 800px;
            background-color: #222;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .panel-header h2 {
            color: #FFD700;
            text-shadow: 0 0 5px #FFD700;
            margin: 0;
            flex-grow: 1;
            text-align: center;
        }

        #logout-button {
            background-color: #dc3545;
            color: #fff;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease;
            white-space: nowrap;
            margin-left: 15px;
        }

        #logout-button:hover {
            background-color: #c82333;
        }

        /* Dashboard Specific Styles */
        #dashboard-view {
            display: none;
            width: 100%;
            max-width: 800px;
            text-align: center;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #dashboard-view .dashboard-cards {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
        }

        #dashboard-view .dashboard-card {
            background-color: #222;
            border: 3px groove #FFD700;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            text-align: center;
            flex: 0 0 100%;
            max-width: 800px;
        }

        #dashboard-view .dashboard-card h3 {
            color: #FFD700;
            margin-bottom: 15px;
            text-shadow: 0 0 5px #FFD700;
        }

        #dashboard-view .dashboard-card .value {
            font-size: 2.5em;
            font-weight: bold;
            color: #00ff00;
            margin-bottom: 10px;
        }

        #dashboard-view .dashboard-member-list {
            background-color: #222;
            border: 3px groove #FFD700;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        #dashboard-view .dashboard-member-list h4 {
            color: #FFD700;
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
            text-shadow: 0 0 3px #FFD700;
        }

        #dashboard-view .dashboard-member-list ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #dashboard-view .dashboard-member-list li {
            color: #fff;
            padding: 5px 0;
            border-bottom: 1px solid #555;
        }

        #dashboard-view .dashboard-member-list li:last-child {
            border-bottom: none;
        }

        /* Player Management View - Make sure it displays correctly */
        #player-management-view {
            display: none; /* Controlled by JS */
            width: 100%;
            max-width: 800px; /* Lebar maksimum konsisten */
            flex-direction: column;
            align-items: center;
            gap: 20px; /* Jarak antar elemen utama di view ini */
        }

        /* Styles for Leaderboard within Player Management - INI FOKUS UTAMA PERBAIKAN */
        /* Menggunakan style dari script yang Anda berikan (warna FF920C) */
        .admin-panel { /* Ini untuk "ADMIN LEADERBOARD PANEL" */
            background-color: #4a4a4a;
            border: 3px #FF920C groove;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px; /* Jarak bawah */
            width: 100%;
            max-width: 600px; /* Lebar maksimum untuk form input */
            box-shadow: 0 0 15px rgba(208, 168, 89, 0.7);
        }

        .admin-panel h3 { /* Judul di admin panel */
            color: #FF920C;
            text-shadow: 0 0 5px #FF920C;
            text-align: center;
            margin-bottom: 20px;
        }

        .admin-panel input[type="text"],
        .admin-panel input[type="number"],
        .admin-panel input[type="date"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #FF920C;
            background-color: #222;
            color: #fff;
            border-radius: 5px;
        }

        .admin-panel button {
            background-color: #008000;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }

        .admin-panel button:hover {
            background-color: #00aa00;
        }

        .admin-panel button.delete-btn {
            background-color: #dc3545;
        }

        .admin-panel button.delete-btn:hover {
            background-color: #a71d2a;
        }

        .admin-id-list { /* Ini untuk "Daftar ID Player (Full & Masked)" */
            margin-top: 20px;
            background-color: #3d3d3d;
            border: 1px solid #FF920C;
            border-radius: 8px;
            padding: 10px;
        }
        .admin-id-list h4 {
            color: #FF920C;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 3px #FF920C;
        }
        .admin-id-list table {
            width: 100%;
            border-collapse: collapse; /* Penting untuk border */
        }
        .admin-id-list th,
        .admin-id-list td {
            border: 1px solid #555;
            padding: 8px;
            text-align: left;
            color: #fff;
        }
        .admin-id-list th {
            background-color: #555;
            color: #FF920C;
        }


        .ardframe.checkpoin { /* Ini untuk leaderboard utama */
            border: 3px #FF920C groove;
            border-radius: 10px;
            padding: 20px;
            background-color: #333;
            box-shadow: 0 0 15px rgba(255, 146, 12, 0.7);
            width: 100%; /* Memastikan mengisi lebar parent */
            max-width: 800px; /* Lebar maksimum konsisten */
            margin: 0 auto; /* Memusatkan secara horizontal */
        }
        .table-ard-container { /* Kontainer tabel leaderboard utama */
            max-height: 350px;
            overflow-y: auto;
            border: 3px #FF920C groove;
            border-radius: 10px;
        }
        .table-ard {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0; /* Hapus spasi antar sel */
        }
        .table-ard thead th {
            font-family: 'Anek Latin', sans-serif;
            text-shadow: 0 0 3px #000, 0 0 5px #000;
            border: 3px #FF920C groove;
            color: #fff;
            padding: 10px;
            text-align: center;
            vertical-align: middle;
            border-radius: 10px;
            background-color: #555;
            padding: 15px 10px;
            font-size: 18px !important;
            border-bottom: 1px solid white;
            filter: drop-shadow(1px 2px 6px gold);
            position: sticky;
            top: 0;
            z-index: 1;
            box-sizing: border-box;
        }
        .table-ard tbody td {
            font-family: 'Anek Latin', sans-serif;
            text-shadow: 0 0 3px #000, 0 0 5px #000;
            border: 3px #FF920C groove; /* Border per sel di tabel utama */
            color: #fff;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
            border-radius: 10px;
            box-sizing: border-box;
        }
        /* Baris ganjil/genap */
        .table-ard tbody tr:nth-child(odd) {
            background-color: #444;
        }
        .table-ard tbody tr:nth-child(even) {
            background-color: #3d3d3d;
        }


        .search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search input {
            flex-grow: 1;
            padding: 8px;
            border: 3px #FF920C groove;
            background-color: #222;
            color: #fff;
            border-radius: 10px;
        }

        .search div[role="button"] {
            background-color: #FF920C;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
        }

        .search div[role="button"] img {
            height: 24px;
        }

        .ardboard {
            margin-top: 20px;
        }

        /* Styles for Reward Image Popup */
        .layer2 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .reward {
            background-color: #333 !important;
            padding: 20px;
            border: 3px #FF920C groove !important;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 0 20px rgba(255, 146, 12, 0.8) !important;
        }

        .reward .ard-close {
            background-color: #555 !important;
            border: 3px #FF920C groove !important;
        }

        .reward .ard-close:hover {
            background-color: #e08200 !important;
        }

        /* --- Custom Welcome Pop-up Styles --- */
        .custom-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7); /* Background gelap transparan */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .custom-popup-content {
            background-color: #222; /* Background gelap pop-up */
            border: 3px groove #FFD700; /* Border emas */
            border-radius: 10px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); /* Shadow emas */
            animation: fadeInScale 0.3s ease-out;
        }

        .custom-popup-content .check-icon {
            font-size: 3em;
            color: #00ff00; /* Hijau untuk centang */
            margin-bottom: 15px;
            filter: drop-shadow(0 0 5px rgba(0,255,0,0.5));
        }

        .custom-popup-content h3 {
            color: #fff;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .custom-popup-content p {
            color: #FFD700; /* Warna emas untuk teks utama */
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255,215,0,0.5);
        }

        .custom-popup-content .popup-button {
            background-color: #007bff; /* Biru cerah untuk tombol OK */
            color: #fff;
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }

        .custom-popup-content .popup-button:hover {
            background-color: #0056b3;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }


        /* Mobile specific adjustments */
        @media (max-width: 767px) {
            .login-container {
                max-width: 90%;
                padding: 20px;
            }

            .login-container h2 {
                font-size: 1.8em;
            }

            .login-container button {
                font-size: 1em;
                padding: 8px 20px;
            }

            .sidebar {
                width: 100px;
                padding-top: 10px;
            }
            .sidebar-header h2 {
                font-size: 1.2em;
            }
            .sidebar-menu ul li a {
                padding: 8px 10px;
                font-size: 0.9em;
                justify-content: center;
                flex-direction: column;
                margin: 0 5px;
                width: calc(100% - 10px);
            }
            .sidebar-menu .submenu {
                margin-left: 0;
                border-left: none;
            }
            .sidebar-menu .submenu li a {
                padding: 5px 10px;
                font-size: 0.8em;
            }

            .main-content {
                padding: 10px;
            }

            .panel-header {
                max-width: 95%;
                flex-direction: column;
                align-items: center;
            }

            .panel-header h2 {
                font-size: 1.2em;
            }

            #logout-button {
                position: relative;
                top: auto;
                right: auto;
                transform: none;
                margin-top: 10px;
                margin-left: 0;
                width: 100%;
            }

            .checkpoin,
            .admin-panel,
            #dashboard-view .dashboard-card,
            #dashboard-view .dashboard-member-list {
                width: 95%;
                padding: 15px;
            }

            .title h1 {
                font-size: 2.2em;
            }

            .search input,
            .admin-panel input,
            .admin-panel button {
                font-size: 0.9em;
                padding: 6px;
            }

            .table-ard th,
            .table-ard td {
                font-size: 0.8em !important;
                padding: 6px;
            }

            .marquee {
                width: 90%;
            }

            #dashboard-view .dashboard-card {
                min-width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="login-container" id="login-form">
        <div class="logo-login">
            <img src="https://cdn.it-cg.group/mysterybox/uploads/684c61560f2b8.Logo%20%282%29.png" alt="Company Logo">
        </div>
        <div class="form-group">
            <label for="username">ID Pengguna:</label>
            <input type="text" id="username" placeholder="Masukkan ID Pengguna">
        </div>
        <div class="form-group">
            <label for="password">Kata Sandi:</label>
            <input type="password" id="password" placeholder="Masukkan Kata Sandi">
        </div>
        <button onclick="checkLogin()">Login</button>
        <p class="login-error" id="login-error-message" style="display: none;">ID Pengguna atau Kata Sandi salah!</p>
        <p class="login-footer-text">Set Up By JX ©2025</p>
    </div>

    <div id="main-panel-content">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Admin Panel</h2>
            </div>
            <nav class="sidebar-menu">
                <ul>
                    <li><a href="#" class="nav-link active" data-view="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li>
                        <a href="#" class="nav-link dropdown-toggle" data-view="data-member"><i class="fas fa-users"></i> Data Member</a>
                        <ul class="submenu">
                            <li><a href="#" class="nav-link" data-view="player-management">Player</a></li>
                            </ul>
                    </li>
                    </ul>
            </nav>
        </div>

        <div class="main-content">
            <div class="panel-header">
                <h2 id="welcome-text">PANEL SET UP MEMBER PASJACKPOT</h2>
                <button id="logout-button" onclick="logout()">Logout <i class="fas fa-sign-out-alt"></i></button>
            </div>

            <div id="dashboard-view">
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <h3><i class="fas fa-users"></i> Total Registered Members</h3>
                        <div class="value" id="total-registered-members">0</div>
                    </div>
                </div>
                <div class="dashboard-member-list">
                    <h4>Daftar ID Member</h4>
                    <ul id="dashboard-member-id-list">
                        </ul>
                </div>
            </div>

            <div id="player-management-view">
                <div class="title-container">
                    <div class="title rsive">
                        <h1>LEADERBOARD</h1>
                    </div>
                    <center style="width: 100%;">
                        <div class="marquee">
                            <div class="marquee-content">
                                <b> UPDATE POINT LEADERBOARD PAS JACKPOT </b>
                            </div>
                        </div>
                    </center>
                </div>

                <div class="admin-panel">
                    <h3>ADMIN LEADERBOARD PANEL</h3>
                    <div class="form-group">
                        <label for="admin_user_id">ID Player:</label>
                        <input type="text" id="admin_user_id" placeholder="Masukkan ID Player">
                    </div>
                    <div class="form-group">
                        <label for="admin_points">Poin:</label>
                        <input type="number" id="admin_points" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label for="admin_joined_date">Joined Date:</label>
                        <input type="date" id="admin_joined_date">
                    </div>
                    <div class="form-group">
                        <button onclick="addOrUpdatePlayer()">Tambah / Update Player</button>
                        <button class="delete-btn" onclick="deletePlayer()">Hapus Player (berdasarkan ID)</button>
                    </div>

                    <div class="admin-id-list">
                        <h4>Daftar ID Player (Full & Masked)</h4>
                        <div style="max-height: 200px; overflow-y: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ID Lengkap</th>
                                        <th>ID Tersembunyi</th>
                                    </tr>
                                </thead>
                                <tbody id="admin_id_list_body">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="ardframe rsive checkpoin">
                    <div class="search">
                        <input class="ardframe" maxlength="12" type="text" name="user" id="user" placeholder="USER ID">
                        <div role="button" type="submit" onclick="searchLeaderboard()">
                            <img src="https://wall2.airbet88-vip.com/assets/desktop/search.webp" alt="Search">
                        </div>
                    </div>
                    <main class="ardboard">
                        <div id="klasemen">
                            <div class="card-body p-1 p-lg-3 rankto onn">
                                <div class="table-ard-container">
                                    <table class="table-ard">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <span>ID PLAYER</span>
                                                </th>
                                                <th>
                                                    <span>POIN</span>
                                                </th>
                                                <th>
                                                    <span>JOINED DATE</span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <div class="layer2"
                style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:1000; justify-content:center; align-items:center;">
                <div class="ardframe reward"
                    style="background-color:#333; padding:20px; border:3px #FF920C groove; border-radius:10px; max-width:600px; width:90%; box-shadow:0 0 20px rgba(255,146,12,0.8);">
                    <div class="content-text">
                        <div id="carouselhadiah" class="carousel slide">
                            <div class="carousel-indicators">
                                <button type="button" data-bs-target="#carouselhadiah" data-bs-slide-to="0" class="active"
                                    aria-current="true" aria-label="Slide 1"></button>
                                <button type="button" data-bs-target="#carouselhadiah" data-bs-slide-to="1"
                                    aria-label="Slide 2"></button>
                            </div>
                            <div class="carousel-inner m-auto">
                                <div class="carousel-item active">
                                    <img id="carouselImage1" src="" alt="1" class="desktop-image"
                                        style="max-width: 100%; height: auto; display: block; margin: auto;">
                                </div>
                                <div class="carousel-item">
                                    <img id="carouselImage2" src="" alt="2" class="desktop-image"
                                        style="max-width: 100%; height: auto; display: block; margin: auto;">
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselhadiah"
                                data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselhadiah"
                                data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                    <div class="btn-container" style="margin-top:20px;">
                        <div class="ardframe ard-close" onclick="hideRewardList()" role="button"
                            style="border: 3px #FF920C groove; border-radius: 10px; padding: 8px 15px; text-shadow: 0 0 3px #000, 0 0 5px #000; color: #fff; cursor:pointer; background-color:#555;">
                            CLOSE
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="welcome-popup-overlay" class="custom-popup-overlay" style="display: none;">
        <div class="custom-popup-content">
            <div class="check-icon"><i class="fas fa-check-circle"></i></div>
            <h3>Welcome</h3>
            <p id="popup-username">PIC_PSJ</p>
            <p>You've Been Successfully Login</p>
            <button class="popup-button" onclick="hideWelcomePopup()">OK</button>
        </div>
    </div>

    <script>
        // --- Firebase Configuration & Initialization ---
        // INI SUDAH CONFIGURASI PROYEK FIREBASE ANDA DARI SCREENSHOT TERBARU
        const firebaseConfig = {
            apiKey: "AIzaSyC5_JTdIVZUpnTirNTLci7oRKSzi7ne_4c",
            authDomain: "absherlin-ddb58.firebaseapp.com",
            projectId: "absherlin-ddb58",
            storageBucket: "absherlin-ddb58.firebasestorage.app",
            messagingSenderId: "360615330096",
            appId: "1:360615330096:web:ddc9f4a3fb7f3af2d388f5",
            measurementId: "G-HL1WT808N5"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = app.firestore(); // Dapatkan instance Firestore

        let leaderboardData = []; // Kosongkan, karena data akan di-fetch dari Firestore

        // --- Fungsi untuk Memformat Username (Masking) ---
        function maskUsername(username) {
            if (username.length <= 4) return username;
            return username.substring(0, 2) + "***" + username.substring(username.length - 2, username.length);
        }

        // --- Dashboard Functions ---
        function updateDashboardStats() {
            $('#total-registered-members').text(leaderboardData.length);
        }

        function renderDashboardMemberList() {
            const memberListUl = $('#dashboard-member-id-list');
            memberListUl.empty();

            if (leaderboardData.length > 0) {
                const sortedMembers = [...leaderboardData].sort((a, b) => a.username.localeCompare(b.username));
                sortedMembers.forEach(player => {
                    memberListUl.append(`<li>${player.username}</li>`);
                });
            } else {
                memberListUl.append(`<li>No members registered yet.</li>`);
            }
        }

        // --- Leaderboard/Player Management Functions ---
        function renderLeaderboard(dataToShow) {
            let htmlView = '';
            const tbody = $('.table-ard tbody');

            if (dataToShow.length <= 0) {
                htmlView += `
                    <tr>
                        <td colspan="3" style="border: unset; border-radius: 10px; padding: 5px; text-shadow: 0 0 3px #000000, 0 0 5px #000000; border-color: #d0a859; color: #fff; border: 3px #FF920C groove; ">No data.</td>
                    </tr>`;
            } else {
                dataToShow.sort((a, b) => b.point - a.point); // Sortir dari poin tertinggi

                for (let i = 0; i < dataToShow.length; i++) {
                    let player = dataToShow[i];
                    htmlView +=
                        `<tr>
                            <td class="mb-3 table-ard-point position-relative">` +
                        maskUsername(player.username) + `</td>
                            <td class="mb-3 table-ard-point position-relative">` +
                        player.point + `</td>
                            <td class="mb-3 table-ard-point position-relative">` +
                        player.joined_date + `</td>
                        </tr>`;
                }
            }
            tbody.html(htmlView);

            // Perbaikan styling inline untuk sel tabel agar konsisten dengan gambar
            $('.table-ard tbody td').each(function() {
                $(this).css({
                    'border': '3px #FF920C groove', /* Menggunakan groove border yang diminta */
                    'border-radius': '10px',
                    'padding': '8px',
                    'text-align': 'center',
                    'vertical-align': 'middle',
                    'color': '#fff',
                    'text-shadow': '0 0 3px #000, 0 0 5px #000'
                });
            });
            // Pastikan thead th juga konsisten
            $('.table-ard thead th').each(function() {
                $(this).css({
                    'border': '3px #FF920C groove', /* Konsisten dengan groove */
                    'border-radius': '10px',
                    'padding': '15px 10px',
                    'background-color': '#555',
                    'color': '#fff',
                    'text-align': 'center',
                    'vertical-align': 'middle',
                    'font-size': '18px',
                    'border-bottom': '1px solid white',
                    'filter': 'drop-shadow(1px 2px 6px gold)'
                });
            });
             // Styling untuk baris ganjil/genap
            $('.table-ard tbody tr:nth-child(odd) td').css('background-color', '#444');
            $('.table-ard tbody tr:nth-child(even) td').css('background-color', '#3d3d3d');
        }

        function renderAdminIdList() {
            let htmlView = '';
            const adminIdListBody = $('#admin_id_list_body');
            adminIdListBody.empty();

            if (leaderboardData.length <= 0) {
                htmlView += `
                    <tr>
                        <td colspan="2" style="text-align: center;">No player IDs added yet.</td>
                    </tr>`;
            } else {
                const sortedLeaderboardData = [...leaderboardData].sort((a, b) => a.username.localeCompare(b.username));
                sortedLeaderboardData.forEach(player => {
                    htmlView += `
                        <tr>
                            <td>${player.username}</td>
                            <td>${maskUsername(player.username)}</td>
                        </tr>
                    `;
                });
            }
            adminIdListBody.html(htmlView);

            // Terapkan kembali border setelah rendering pada tabel admin-id-list
            $('#admin_id_list_body td').css({
                'border': '1px solid #555',
                'padding': '8px',
                'text-align': 'left',
                'color': '#fff'
            });
            $('#admin_id_list_body').parent().prev('thead').find('th').css({
                'background-color': '#555',
                'color': '#FF920C',
                'border': '1px solid #555'
            });
        }

        function searchLeaderboard() {
            var keyword = $('#user').val().toLowerCase();
            let filteredData = leaderboardData.filter(player =>
                player.username.toLowerCase().includes(keyword) ||
                player.point.toString().includes(keyword) ||
                player.joined_date.includes(keyword)
            );
            renderLeaderboard(filteredData);
        }

        // --- Fungsi untuk Mengambil Data Leaderboard dari Firestore (Real-time) ---
        async function fetchLeaderboardData() {
            try {
                // onSnapshot akan memanggil callback setiap kali ada perubahan di koleksi 'players'
                db.collection("players").orderBy("point", "desc")
                    .onSnapshot((querySnapshot) => {
                        leaderboardData = [];
                        querySnapshot.forEach((doc) => {
                            leaderboardData.push({ id: doc.id, ...doc.data() });
                        });
                        leaderboardData.sort((a, b) => b.point - a.point); // Data sudah otomatis terurut dari Firestore, tapi kita bisa pastikan lagi
                        
                        renderLeaderboard(leaderboardData); // Perbarui tampilan leaderboard
                        renderAdminIdList(); // Perbarui daftar ID admin
                        updateDashboardStats(); // Perbarui jumlah total member
                        renderDashboardMemberList(); // Perbarui daftar ID member di dashboard
                        console.log("Leaderboard updated from Firestore (real-time)!");
                    }, (error) => {
                        console.error("Error getting real-time updates from Firestore: ", error);
                        alert('Gagal mengambil data leaderboard. Periksa konsol.');
                    });
            } catch (error) {
                console.error('Error initiating Firestore listener:', error);
                alert('Gagal terhubung ke Firestore. Periksa konfigurasi Firebase Anda.');
            }
        }

        // --- Fungsi Panel Admin: Tambah / Update Player ---
        async function addOrUpdatePlayer() {
            let id = $('#admin_user_id').val().trim();
            let points = parseInt($('#admin_points').val());
            let date = $('#admin_joined_date').val();

            if (!id || isNaN(points) || !date) {
                alert("Semua field harus diisi dengan benar!");
                return;
            }

            // Format tanggal ke DD-MM-YYYY
            const [year, month, day] = date.split('-');
            const formattedDate = `${day}-${month}-${year}`;

            const playerData = {
                username: id, // Gunakan username sebagai ID dokumen Firestore
                point: points,
                joined_date: formattedDate
            };

            try {
                // Tulis data ke Firestore. .set dengan {merge: true} akan update jika ada, tambah jika tidak ada.
                await db.collection("players").doc(id).set(playerData, { merge: true });
                alert(`Player ${id} berhasil diproses di Firestore!`);
                clearAdminForm();
                // onSnapshot akan otomatis memperbarui tampilan
            } catch (error) {
                console.error('Error adding/updating player:', error);
                alert('Gagal menambah/mengupdate player di Firestore. Pastikan aturan keamanan Anda memperbolehkan penulisan.');
            }
        }

        // --- Fungsi Panel Admin: Hapus Player ---
        async function deletePlayer() {
            let idToDelete = $('#admin_user_id').val().trim();

            if (!idToDelete) {
                alert("Masukkan ID Player yang ingin dihapus!");
                return;
            }

            if (!confirm(`Anda yakin ingin menghapus player dengan ID: ${idToDelete}?`)) {
                return;
            }

            try {
                // Hapus dokumen berdasarkan ID (username)
                await db.collection("players").doc(idToDelete).delete();
                alert(`Player ${idToDelete} berhasil dihapus dari Firestore!`);
                clearAdminForm();
                // onSnapshot akan otomatis memperbarui tampilan
            } catch (error) {
                console.error('Error deleting player:', error);
                alert('Gagal menghapus player dari Firestore. Pastikan aturan keamanan Anda memperbolehkan penghapusan.');
            }
        }

        // --- Fungsi untuk Membersihkan Form Admin ---
        function clearAdminForm() {
            $('#admin_user_id').val('');
            $('#admin_points').val('0');
            // Set default date for joined_date input to today
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            $('#admin_joined_date').val(`${year}-${month}-${dd}`);
        }

        // --- Reward List Carousel Toggling ---
        function showRewardList() {
            document.querySelector(".layer2").style.display = "flex";
            document.querySelector("html").classList.add("activex2");
            setCarouselImages();
        }

        function hideRewardList() {
            document.querySelector(".layer2").style.display = "none";
            document.querySelector("html").classList.remove("activex2");
        }

        function setCarouselImages() {
            const carouselImage1 = document.getElementById('carouselImage1');
            const carouselImage2 = document.getElementById('carouselImage2');

            carouselImage1.src = carouselImage1.dataset.defaultSrc || "https://via.placeholder.com/400x300?text=Reward+1";
            carouselImage2.src = carouselImage2.dataset.defaultSrc || "https://via.placeholder.com/400x300?text=Reward+2";

            if (window.innerWidth <= 767) {
                carouselImage1.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20B_.png";
                carouselImage2.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20A.png";
            } else {
                carouselImage1.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20D.png";
                carouselImage2.src = "https://cdn-master.it-cg.group/MONEYSITE/AI88%20VIP/Checkpoin/AIVIP006%20C.png";
            }
            carouselImage1.classList.add('d-block');
            carouselImage2.classList.add('d-block');
        }

        // --- Custom Welcome Pop-up Functions ---
        function showWelcomePopup(username) {
            $('#popup-username').text(username);
            $('#welcome-popup-overlay').fadeIn(300); // Tampilkan dengan fade-in
        }

        function hideWelcomePopup() {
            $('#welcome-popup-overlay').fadeOut(300); // Sembunyikan dengan fade-out
        }

        // --- Logout Function ---
        function logout() {
            if (confirm("Anda yakin ingin logout?")) {
                $('#main-panel-content').hide();
                $('#login-form').show();
                $('#username').val('');
                $('#password').val('');
                $('#login-error-message').hide();
                // Data akan di-refresh dari Firebase saat login berikutnya
                leaderboardData = []; // Kosongkan data di memori
                renderLeaderboard([]);
                renderAdminIdList();
                updateDashboardStats();
                renderDashboardMemberList();
            }
        }

        // --- Logic Login ---
        const CORRECT_USERNAME = "CSPSJ";
        const CORRECT_PASSWORD = "Click8899";
        const PANEL_WELCOME_TEXT = "PANEL SET UP MEMBER PASJACKPOT";

        function checkLogin() {
            const usernameInput = $('#username').val();
            const passwordInput = $('#password').val();
            const errorMessage = $('#login-error-message');

            if (usernameInput === CORRECT_USERNAME && passwordInput === CORRECT_PASSWORD) {
                $('#login-form').hide();
                $('#main-panel-content').css('display', 'flex');
                $('#welcome-text').text(PANEL_WELCOME_TEXT);
                
                initAdminPanel(); // Inisialisasi panel admin (akan memicu fetch data dari Firebase)
                showView('dashboard-view'); // Tampilkan dashboard

                // Panggil pop-up setelah dashboard dimuat sepenuhnya (dengan sedikit delay)
                setTimeout(() => {
                    showWelcomePopup(usernameInput); // Tampilkan username yang login di pop-up
                }, 200); // Waktu yang cukup untuk dashboard muncul
            } else {
                errorMessage.text("ID Pengguna atau Kata Sandi salah!");
                errorMessage.show();
            }
        }

        // Fungsi untuk menampilkan view tertentu di main-content
        function showView(viewId) {
            // Sembunyikan semua view yang bisa di-switch
            $('#dashboard-view').hide();
            $('#player-management-view').hide();

            // Tampilkan view yang diminta
            $(`#${viewId}`).css('display', 'flex'); 

            // Atur class 'active' pada navigasi sidebar
            $('.sidebar-menu .nav-link').removeClass('active');
            $('.sidebar-menu .submenu').removeClass('show'); 
            
            let targetLink;
            // Handle untuk link submenu
            if (viewId === 'player-management-view') {
                targetLink = $(`.sidebar-menu .nav-link[data-view="data-member"]`);
                targetLink.parent().find('.submenu').addClass('show'); // Tampilkan submenu 'Data Member'
                $(`.sidebar-menu .submenu li a[data-view="player-management"]`).addClass('active'); // Aktifkan link 'Player'
            } else { // Untuk Dashboard atau menu level atas lainnya
                targetLink = $(`.sidebar-menu .nav-link[data-view="${viewId.replace('-view', '')}"]`); 
                targetLink.addClass('active');
            }
        }

        // Fungsi inisialisasi panel admin yang akan dipanggil setelah login
        function initAdminPanel() {
            clearAdminForm();

            $('#user').on('keyup', function () {
                searchLeaderboard();
            });

            setCarouselImages();
            $(window).on('resize', setCarouselImages);

            // Event listener untuk navigasi sidebar
            $('.sidebar-menu .nav-link').on('click', function(e) {
                e.preventDefault();
                const targetView = $(this).data('view');
                const isSubmenuLink = $(this).parent().parent().hasClass('submenu');

                if (targetView) {
                    if (targetView === 'player-management') {
                         showView(`${targetView}-view`);
                    } else {
                        showView(`${targetView}-view`);
                    }
                }

                if ($(this).hasClass('dropdown-toggle')) {
                    $(this).next('.submenu').toggleClass('show');
                } else if (!isSubmenuLink) {
                    $('.sidebar-menu .submenu').removeClass('show'); 
                }
            });

            // Panggil ini untuk memastikan data dashboard dan list player terload dari Firebase
            fetchLeaderboardData(); 
        }

        // --- Inisialisasi Saat Dokumen Siap ---
        $(document).ready(function () {
            $('#main-panel-content').hide();
            clearAdminForm(); // Set default date input field
            // fetchLeaderboardData() tidak perlu dipanggil di sini karena akan dipanggil setelah login berhasil
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
</body>

</html>